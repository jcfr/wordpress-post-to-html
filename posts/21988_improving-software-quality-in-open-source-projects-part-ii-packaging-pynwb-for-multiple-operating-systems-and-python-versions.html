<meta charset="utf-8">
<div class="entry-content">
 <p style="text-align: center;">
  <strong>
   Index To the Series
  </strong>
  <br/>
  1.
  <a href="https://blog.kitware.com/how-to-improve-software-quality-in-open-source-projects-part-i-overview-of-continuous-integration-ci-and-software-process-in-pynwb/">
   Overview of Continuous Integration (CI) and Software Process in PyNWB
  </a>
  <br/>
  2.
  <a href="https://blog.kitware.com/improving-software-quality-in-open-source-projects-part-ii-packaging-pynwb-for-multiple-operating-systems-and-python-versions/">
   Packaging PyNWB for Multiple Operating Systems and Python Versions
   <br/>
  </a>
  3.
  <a href="https://blog.kitware.com/how-to-improve-software-quality-in-open-source-projects-part-iii-code-coverage-documentation-and-style">
   Code Coverage, Documentation and Style
  </a>
 </p>
 <hr/>
 <p>
  <span style="font-weight: 400;">
   In our
  </span>
  <a href="https://blog.kitware.com/how-to-improve-software-quality-in-open-source-projects-part-i-overview-of-continuous-integration-ci-and-software-process-in-pynwb/">
   <span style="font-weight: 400;">
    previous post
   </span>
  </a>
  <span style="font-weight: 400;">
   , we introduced the concept of continuous integration (CI) and described its benefits for software quality. In this post, we talk about the nuts and bolts of the
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    PyNWB
   </span>
  </a>
  <span style="font-weight: 400;">
   project such as Python 2 and Python 3 support, cross-platform operating system support, source distributions and dependency versioning.
  </span>
 </p>
 <h2>
  <span style="font-weight: 400;">
   Python 2 and Python 3 Support
  </span>
 </h2>
 <p>
  <span style="font-weight: 400;">
   While we wait for all dependent projects of the PyNWB ecosystem to be updated to support Python 3.x, we still need to support both Python 2.7 and Python 3.6. Using a tool such as
  </span>
  <a href="https://github.com/benjaminp/six" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Six
   </span>
  </a>
  <span style="font-weight: 400;">
   as a compatibility layer between Python versions allows us to write concise code that can work efficiently with Python 2.7 and Python 3.6. Six does not test packages against different Python versions though. In order to run the tests manually, we have to create two virtual environments, establish the software process on both environments and run the tests in both environments.
  </span>
 </p>
 <p>
  <span style="font-weight: 400;">
   Let’s consider what happens if PyNWB also needs to support Python 3.7: The above process must be repeated. To do so, we would use
  </span>
  <a href="http://tox.readthedocs.io/en/latest/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    tox
   </span>
  </a>
  <span style="font-weight: 400;">
   . This is an automation tool and a common standard for creating test environments across different Python versions. It has a simple configuration file called “tox.ini,” which is human readable and can integrate with most CI vendors.
  </span>
 </p>
 <div class="wp-caption aligncenter" id="attachment_21990" style="width: 898px">
  <img alt="" class="size-full wp-image-21990" height="846" sizes="(max-width: 888px) 100vw, 888px" src="http://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File.png" srcset="https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File.png 888w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-300x286.png 300w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-768x732.png 768w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-220x210.png 220w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-250x238.png 250w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-355x338.png 355w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-730x695.png 730w, https://blog.kitware.com/wp-content/uploads/2018/03/Sample-tox.ini-File-90x86.png 90w" width="888"/>
  <p class="wp-caption-text">
   A screenshot shows a sample tox.ini file.
  </p>
 </div>
 <p>
  <span style="font-weight: 400;">
   This specific configuration lets tox create two clean environments with different Python versions (2.7 and 3.6), install the library and test dependencies and run the tests in both environments. We can add a new environment with one more entry to the envlist (such as py37).
  </span>
 </p>
 <p>
  <span style="font-weight: 400;">
   The
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/tox.ini" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    tox file
   </span>
  </a>
  <span style="font-weight: 400;">
   used in the PyNWB project is located in the root directory of the repository. Other files located in the repository are
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/requirements.txt" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    requirements.txt
   </span>
  </a>
  <span style="font-weight: 400;">
   and
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/requirements-dev.txt" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    requirements-dev.txt
   </span>
  </a>
  <span style="font-weight: 400;">
   , which help create a reproducible environment. The
  </span>
  <span style="font-weight: 400;">
   requirements.txt
  </span>
  <span style="font-weight: 400;">
   file lists Python dependencies of the package, and the requirements-dev.txt
  </span>
  <span style="font-weight: 400;">
   file lists Python dependencies for the development of the package. Alternatively,
  </span>
  <span style="font-weight: 400;">
   setup.py
  </span>
  <span style="font-weight: 400;">
   installs the dependencies of the package as part of its installation on a system. The difference between
  </span>
  <span style="font-weight: 400;">
   requirements.txt
  </span>
  <span style="font-weight: 400;">
   and
  </span>
  <span style="font-weight: 400;">
   setup.py
  </span>
  <span style="font-weight: 400;">
   is covered in great detail in “
  </span>
  <a href="https://caremad.io/posts/2013/07/setup-vs-requirement/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    setup.py
   </span>
   <span style="font-weight: 400;">
    vs
   </span>
   <span style="font-weight: 400;">
    requirements.txt
   </span>
  </a>
  <span style="font-weight: 400;">
   .”
  </span>
 </p>
 <p>
  <span style="font-weight: 400;">
   As a side note, you need more than the ability to test code in multiple environments to support two different versions of Python. There are many resources dedicated to this
  </span>
  <a href="http://python-future.org/compatible_idioms.html" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    topic
   </span>
  </a>
  <span style="font-weight: 400;">
   . For PyNWB, we worked with the project’s core maintainers to select a codebase that is compatible with Python 2 and Python 3. We used the
  </span>
  <a href="https://pythonhosted.org/six/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Six
   </span>
  </a>
  <span style="font-weight: 400;">
   library and prevented the inclusion of any Python 3 language features in the codebase. We also worked with the maintainers to accommodate the schedule and requirements of the different elements of the PyNWB ecosystem. Navigating these accommodations is typical when creating a robust and distributed open source community. The “social” tools of clear communication, an articulated
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/docs/CODE_OF_CONDUCT.rst" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    code of conduct
   </span>
  </a>
  ,
  <span style="font-weight: 400;">
   and compromise are every bit as important as the technical tools.
  </span>
 </p>
 <h2>
  <span style="font-weight: 400;">
   Cross-platform Operating System Support
  </span>
 </h2>
 <p>
  <span style="font-weight: 400;">
   A common challenge in CI is testing software across several different operating systems, as the process requires different CI vendors. (Currently, each vendor allows testing to occur on a single operating system for unpaid open source projects.)
  </span>
 </p>
 <p>
  <span style="font-weight: 400;">
   For PyNWB, we use
  </span>
  <a href="https://circleci.com/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    CircleCI
   </span>
  </a>
  <span style="font-weight: 400;">
   for Linux,
  </span>
  <a href="https://www.appveyor.com/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    AppVeyor
   </span>
  </a>
  <span style="font-weight: 400;">
   for Windows and
  </span>
  <a href="https://travis-ci.org/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Travis CI
   </span>
  </a>
  <span style="font-weight: 400;">
   for macOS. All of these platforms can run tests for different Python versions using tox. When compared to scripts that are specific to one platform, tox greatly reduces the maintenance overhead associated with running tests with all three vendors, as it abstracts away platform differences. The fact that the syntax for all three vendors is fairly similar also reduces overhead.
  </span>
 </p>
 <div class="wp-caption aligncenter" id="attachment_21991" style="width: 1132px">
  <img alt="" class="wp-image-21991 size-full" height="1600" sizes="(max-width: 1122px) 100vw, 1122px" src="http://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File.png" srcset="https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File.png 1122w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-210x300.png 210w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-768x1095.png 768w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-718x1024.png 718w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-220x314.png 220w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-250x357.png 250w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-355x506.png 355w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-730x1041.png 730w, https://blog.kitware.com/wp-content/uploads/2018/03/Travis-CI-Configuration-File-90x128.png 90w" width="1122"/>
  <p class="wp-caption-text">
   On macOS, this Travis CI configuration file runs tests for PyNWB.
  </p>
 </div>
 <p>
  <span style="font-weight: 400;">
   For each CI vendor, we employ specific files: a
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/.circleci/config.yml" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    CircleCI file
   </span>
  </a>
  <span style="font-weight: 400;">
   that configures the build on Debian by leveraging Docker images, an
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/appveyor.yml" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    AppVeyor file
   </span>
  </a>
  <span style="font-weight: 400;">
   that configures the build on Windows and a
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/dev/.travis.yml" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Travis CI file
   </span>
  </a>
  <span style="font-weight: 400;">
   that configures the build on macOS.
  </span>
  <a href="https://github.com/pypa/manylinux" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Manylinux
   </span>
  </a>
  <span style="font-weight: 400;">
   is the preferred way to create wheels on Linux based systems for packages that require compilation. With PyNWB since we don’t compile software to build the wheel we just used the Debian images provided by CircleCI. Every time there is a pull request, the build is triggered on all three operating systems, and the results are reported back to GitHub. GitHub notifies services like Read the Docs to build the documentation.
  </span>
 </p>
 <p>
  <span style="font-weight: 400;">
   We set the results of the multiple build systems as requirements for merging a pull request, i.e., a pull request must pass tests on all platforms before it can be merged. To activate the integration between GitHub and the various CI services, we set webhooks on certain events in the GitHub repository.
  </span>
 </p>
 <h2>
  <span style="font-weight: 400;">
   Source and Wheel Distributions
  </span>
 </h2>
 <p>
  <a href="https://pypi.org/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    PyPI
   </span>
  </a>
  <span style="font-weight: 400;">
   is the official Python package distribution center for sending packages to pip. For the PyNWB project, we publish packages on PyPI so that they can be installed using the pip tool. We also publish the packages on GitHub. More specifically, we use
  </span>
  <a href="http://scikit-ci-addons.readthedocs.io/en/latest/addons.html#publish-github-release-py" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    scikit-ci-addons
   </span>
  </a>
  <span style="font-weight: 400;">
   to publish the development (or pre-release) wheels and tarballs we create for the package. We create these wheels and tarballs as part of the CircleCI build. Directives on publishing the development wheel and source distribution on GitHub are available in the
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/pynwb/blob/b715e5523c3e2b2b1bd219c23a8b06cbe6cb9445/.circleci/config.yml#L14-L27" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    CircleCI file
   </span>
  </a>
  <span style="font-weight: 400;">
   .
  </span>
 </p>
 <div class="wp-caption aligncenter" id="attachment_21992" style="width: 1610px">
  <img alt="" class="size-full wp-image-21992" height="473" sizes="(max-width: 1600px) 100vw, 1600px" src="http://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode.png" srcset="https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode.png 1600w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-300x89.png 300w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-768x227.png 768w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-1024x303.png 1024w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-220x65.png 220w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-250x74.png 250w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-355x105.png 355w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-730x216.png 730w, https://blog.kitware.com/wp-content/uploads/2018/03/Development-Mode-90x27.png 90w" width="1600"/>
  <p class="wp-caption-text">
   PyNWB gets installed in development mode.
  </p>
 </div>
 <p>
  <a href="https://conda.io/docs/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Conda
   </span>
  </a>
  <span style="font-weight: 400;">
   has become very popular in the Python community, especially among scientists. We set PyNWB to publish packages to
  </span>
  <a href="https://conda-forge.org/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    conda-forge
   </span>
  </a>
  <span style="font-weight: 400;">
   using a
  </span>
  <a href="https://github.com/NeurodataWithoutBorders/staged-recipes/blob/master/recipes/pynwb/meta.yaml" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    conda-forge recipe
   </span>
  </a>
  <span style="font-weight: 400;">
   so that we can install the latest release from Conda. To learn more about publishing Python packages, we recommend in depth tutorials for
  </span>
  <a href="http://peterdowns.com/posts/first-time-with-pypi.html" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    PyPI
   </span>
  </a>
  <span style="font-weight: 400;">
   and
  </span>
  <a href="https://conda-forge.org/docs/recipe.html" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    Conda
   </span>
  </a>
  <span style="font-weight: 400;">
   .
  </span>
 </p>
 <h2>
  <span style="font-weight: 400;">
   Dependency Versioning
  </span>
 </h2>
 <p>
  <span style="font-weight: 400;">
   The
  </span>
  <a href="https://requires.io/" rel="noopener" target="_blank">
   <span style="font-weight: 400;">
    requires.io
   </span>
  </a>
  <span style="font-weight: 400;">
   service ensures that a development environment is kept up to date, thereby incorporating essential bug fixes, performance improvements and security patches into the environment. The service discovers dependencies in a repository and checks if there are security updates or other updates for a package.
  </span>
 </p>
 <div class="wp-caption aligncenter" id="attachment_21993" style="width: 748px">
  <img alt="" class="size-full wp-image-21993" height="554" sizes="(max-width: 738px) 100vw, 738px" src="http://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_.png" srcset="https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_.png 738w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-300x225.png 300w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-220x165.png 220w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-250x188.png 250w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-355x266.png 355w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-730x548.png 730w, https://blog.kitware.com/wp-content/uploads/2018/03/Output-from-requires.io_-90x68.png 90w" width="738"/>
  <p class="wp-caption-text">
   Sample output comes from the requires.io service for project dependencies.
  </p>
 </div>
 <p>
  <span style="font-weight: 400;">
   When all of the requirements are up-to-date, requires.io furnishes the repository with this shiny badge:
  </span>
 </p>
 <p>
  <img alt="" class="aligncenter size-full wp-image-21994" height="28" sizes="(max-width: 165px) 100vw, 165px" src="http://blog.kitware.com/wp-content/uploads/2018/03/Requirements-Badge.png" srcset="https://blog.kitware.com/wp-content/uploads/2018/03/Requirements-Badge.png 165w, https://blog.kitware.com/wp-content/uploads/2018/03/Requirements-Badge-90x15.png 90w" width="165"/>
 </p>
 <p>
  <span style="font-weight: 400;">
   For PyNWB, we operate in a very fast-moving environment. Every time there is a change in the PyNWB code (either a Pull Request or an update to the integration branch), our test suite checks the changes against three operating systems (Linux, macOS, and Windows), three versions of Python (2.7, 3.5 and 3.6) and two package managers (pip and Conda). Running the tests against all of these systems, versions and managers makes us confident that we are not breaking code for a wide array of users.
  </span>
 </p>
</div>
