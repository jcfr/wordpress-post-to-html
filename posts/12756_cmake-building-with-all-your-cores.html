<meta charset="utf-8">
<div class="entry-content">
 <p>
  <a href="/blog/files/4_986754587.png" rel="noopener" target="_blank">
   <img alt="" src="https://blog.kitware.com/blog/files/Small.4_986754587.png" width="100%"/>
  </a>
 </p>
 <h1>
  CMake: Building with all your cores
 </h1>
 <p>
  As a distance runner, it is important to run using a fully engaged core. This allows for the most efficient means of moving towards my running goals. Software developers are equally motivated to use as much of their “cores” as possible to build software. OK, I admit this is a bit of a lame analogy, but I don’t think you would find too many developers that are not interested in building software as fast as possible using all of the horse power available on the hardware they are using. The CMake build system and its developers have always been aware of how important parallel builds are, and have made sure that CMake could take advantage of them when possible.
 </p>
 <p>
  Since CMake is a Meta build tool that does not directly build software, but rather generates build files for other tools, the approaches to parallel building differ from generator to generator and platform to platform. In this blog, I will cover the approaches for parallel builds on the major platforms and tool chains supported by CMake.
 </p>
 <p>
  First some terms:
 </p>
 <ul>
  <li>
   <strong>
    Target Level Parallelism
   </strong>
   – This is when a build system builds high level targets at the same time. High level targets are things like libraries and executables.
  </li>
  <li>
   <strong>
    Object Level Parallelism
   </strong>
   – This is when a build system builds individual object files at the same time. Basically, it invokes the compiler command line for independent objects at the same time.
  </li>
  <li>
   <strong>
    CMake generator
   </strong>
   – A CMake generator is a target build tool for CMake. It is specified either in the cmake-gui or with the –G command line option to cmake.
  </li>
 </ul>
 <p>
  I will start with Linux, followed by Apple OSX, and finish up with Windows.
 </p>
 <h2>
  Linux:
 </h2>
 <h3>
  GNU Make
 </h3>
 <p>
  The traditional gmake tool which is usually installed as “make” on Linux systems can run parallel builds. It is used by CMake’s “Unix Makefiles” generator. To have parallel builds with gmake, you need to run gmake with the –jN command line option. The flag tells make to build in parallel. The N argument is used to specify how many jobs are run in parallel during the build. For minimum build times, you want to use a value of N that is one more than the number of cores on the machine.  So, if you have a quad core Linux machine, you would run make –j5.  Here is an example:
 </p>
 <p>
  # assume your source code is in a directory called src and you are one directory up from there
 </p>
 <table border="0" style="background-color: #f3c37b;">
  <tbody>
   <tr>
    <td>
     <span style="font-family: 'courier new', courier;">
      mkdir build
     </span>
    </td>
   </tr>
  </tbody>
 </table>
</div>