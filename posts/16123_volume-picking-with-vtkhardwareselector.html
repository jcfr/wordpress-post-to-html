<meta charset="utf-8">
<div class="entry-content">
 <p>
  Picking is one of the most basic operations to interact with a 3D scene.  The Visualization Toolkit (VTK) supports picking objects from a scene through different classes, each of which are used to select different entities (actors, cells, etc.).   Traditionally, VTK’s volume mappers support picking through an instance external to the mapper itself called vtkVolumePicker which casts a ray into the volume and returns the point where the ray intersects an isosurface of a user specified opacity.  This technique has certain limitations given that the picking class does not have enough information to correctly account for clipping, transfer functions and other parameters which define internally how the mapper renders, which reduces its overall reliability on the actual objects being picked.
 </p>
 <p>
  In an
  <a href="https://blog.kitware.com/volume-rendering-improvements-in-vtk/">
   earlier blog post
  </a>
  the plan of extending vtkGPURayCastMapper (OpenGL2 backend) to make use of vtkHardwareSelector’s interface was discussed, this functionality is finally available as of VTK 7.1.0.  The inherent flexibility of the glsl-based implementation of this mapper allows a seamless integration of the hardware selector, which allows consistent picking of objects in a scene regardless of whether these represent geometric or volumetric data.  Providing picking support directly within the fragment shader of the volume mapper ensures high selection accuracy even in situations where a volume intermixes with geometry in seemingly cumbersome ways (Figure 1) or advanced features like clipping planes are enabled (what you see is what you pick).
 </p>
 <div class="wp-caption aligncenter" id="attachment_16124" style="width: 410px">
  <img alt="TestGPURayCastVolumePicking" class="wp-image-16124 size-full" height="400" sizes="(max-width: 400px) 100vw, 400px" src="https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking.png" srcset="https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking.png 400w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-300x300.png 300w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-220x220.png 220w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-250x250.png 250w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-355x355.png 355w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-90x90.png 90w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-32x32.png 32w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-50x50.png 50w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-64x64.png 64w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-96x96.png 96w, https://blog.kitware.com/wp-content/uploads/2016/10/TestGPURayCastVolumePicking-128x128.png 128w" width="400"/>
  <p class="wp-caption-text">
   Figure 1. The volume’s extent is outlined given that some of the opaque voxels of the vase have been selected (see TestGPURayCastVolumePicking, a minimal example to get started).
  </p>
 </div>
 <p style="text-align: left">
  Furthermore, this initial implementation supports a higher picking granularity than only the volume object itself (vtkProps).   Given the readily available picking styles supported by vtkHardwareSelector (e.g. vtkAreaPicker), it is possible to select a specific set of voxels (Figures 2 and 3).  Hardware volume picking has also been exposed to ParaView and will be available in release 5.2.
 </p>
 <div class="wp-caption aligncenter" id="attachment_16126" style="width: 410px">
  <img alt="humerus-scapula_2_selection_cut" class="wp-image-16126" height="396" sizes="(max-width: 400px) 100vw, 400px" src="https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-300x297.png" srcset="https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-300x297.png 300w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-768x761.png 768w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-1024x1015.png 1024w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-220x218.png 220w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-250x248.png 250w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-355x352.png 355w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-730x723.png 730w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-90x89.png 90w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-32x32.png 32w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-50x50.png 50w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-64x64.png 64w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-96x96.png 96w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut-128x128.png 128w, https://blog.kitware.com/wp-content/uploads/2016/10/humerus-scapula_2_selection_cut.png 1086w" width="400"/>
  <p class="wp-caption-text">
   Figure 2. Selection of front voxels corresponding to the humerus and scapula in ParaView.
  </p>
 </div>
 <p style="text-align: center">
  <div class="wp-caption aligncenter" id="attachment_16127" style="width: 410px">
   <img alt="wavelet_3_selection_cut" class="wp-image-16127" height="399" sizes="(max-width: 400px) 100vw, 400px" src="https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-300x300.png" srcset="https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-300x300.png 300w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-768x765.png 768w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-1024x1020.png 1024w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-220x219.png 220w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-250x249.png 250w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-355x354.png 355w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-730x727.png 730w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-90x90.png 90w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-32x32.png 32w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-50x50.png 50w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-64x64.png 64w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-96x96.png 96w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut-128x128.png 128w, https://blog.kitware.com/wp-content/uploads/2016/10/wavelet_3_selection_cut.png 1080w" width="400"/>
   <p class="wp-caption-text">
    Figure 3. Selection of wavelet voxels in ParaView.
   </p>
  </div>
  <p>
   <strong>
    Acknowledgements
   </strong>
  </p>
  <p>
   We would like to thank the National Institutes of Health for sponsoring this work under the grant NIH R01EB014955 “Accelerating Community-Driven Medical Innovation with VTK.”
  </p>
 </p>
</div>
