<meta charset="utf-8">
<div class="entry-content">
 <p>
  For many developers using VTK, file system introspection tools in SystemTools can be very useful. One issue with them though is that they don’t always work well in parallel when trying to use HPC machines. Think about 10,000 processes trying to determine simultaneously if a file exists. That’s a whole lot of requests hitting the file system at once for a very small piece of information. A better way to do this would be to have a single process determine if the file exists and broadcast a message letting the other processes know the status of the file.
 </p>
 <p>
  To make this easier to do in parallel, we’ve added the
  <a href="http://www.vtk.org/doc/nightly/html/classvtkPSystemTools.html" rel="noopener noreferrer" target="_blank">
   vtkPSystemTools
  </a>
  class to VTK. Its methods do all file system introspection operations on process 0 and then uses vtkMultiProcessController’s global controller to communicate that information to the other processes. The current methods that are implemented in vtkPSystemTools as static classes are:
 </p>
 <ul>
  <li>
   static void BroadcastString(std::string&amp;, int proc)
  </li>
  <li>
   static std::string CollapseFullPath(const std::string&amp; in_relative)
  </li>
  <li>
   static std::string CollapseFullPath(const std::string&amp; in_relative,
   <br/>
   const char* in_base)
  </li>
  <li>
   static bool FileExists(const char* filename, bool isFile)
  </li>
  <li>
   static bool FileExists(const std::string&amp; filename, bool isFile)
  </li>
  <li>
   static bool FileExists(const char* filename)
  </li>
  <li>
   static bool FileExists(const std::string&amp; filename)
  </li>
  <li>
   static bool FileIsDirectory(const std::string&amp; name)
  </li>
  <li>
   static bool FindProgramPath(const char* argv0, std::string&amp; pathOut, std::string&amp; errorMsg, const char* exeName = 0, const char* buildDir = 0, const char* installPrefix = 0)
  </li>
  <li>
   static std::string GetCurrentWorkingDirectory(bool collapse =true)
  </li>
  <li>
   static std::string GetProgramPath(const std::string&amp;)
  </li>
 </ul>
 <p>
  Note that all of these methods except for the BroadcastString method are in SystemTools with the same exact signature which makes switching to using the efficient parallel version extremely simple.
 </p>
 <p>
  This is still a work in progress with not all of SystemTools’ methods that access the file system yet added to vtkPSystemTools. Similarly, the
  <a href="http://www.vtk.org/doc/nightly/html/classvtkPDirectory.html" rel="noopener noreferrer" target="_blank">
   vtkPDirectory
  </a>
  class has parallel efficient implementations of functions in the vtkDirectory and Directory classes.
 </p>
 <p>
  Additionally, we hope to have other methods added to reduce file introspection in parallel. If you decide to use these methods though, make sure that all processes are calling them simultaneously so that none of the processes hang.
 </p>
 <p>
  These methods will be used in the ParaView 5.1 release for faster startup when loading configuration files, plugins and other initialization procedures. They should also have a significant reduction in initialization times for Catalyst enabled simulation runs.
 </p>
</div>
