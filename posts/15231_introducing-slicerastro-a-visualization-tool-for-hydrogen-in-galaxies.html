<meta charset="utf-8">
<div class="entry-content">
 <p>
  <img alt="SlicerAstroIcon" class="alignleft wp-image-15233" height="201" sizes="(max-width: 200px) 100vw, 200px" src="https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon.jpg 597w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-300x300.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-220x221.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-250x251.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-355x356.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-90x90.jpg 90w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-32x32.jpg 32w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-50x50.jpg 50w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-64x64.jpg 64w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-96x96.jpg 96w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroIcon-128x128.jpg 128w" width="200"/>
  Upcoming neutral hydrogen (HI) surveys will deliver large data sets, in which daily dataflow will reach one terabyte. One of these surveys, Apertif [1], will provide information about HI in and around hundreds of thousands of galaxies. To find and characterize HI objects, automated processing methods must use all of the three-dimensional (3D) information (two positional dimensions and one spectral dimension) that the surveys make available. Three-dimensional visualization is essential to the qualitative and quantitative human inspection of results from automated source-finding and analysis pipelines [2].
 </p>
 <div class="wp-caption aligncenter" id="attachment_15241" style="width: 560px">
  <img alt="Well-resolved optical and HI emissions come from a face-on galaxy." class="size-full wp-image-15241" height="284" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1-300x155.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1-220x114.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1-250x129.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1-355x183.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC6964-1-90x46.jpg 90w" width="550"/>
  <p class="wp-caption-text">
   Well-resolved optical and HI emissions come from a face-on galaxy.
  </p>
 </div>
 <p>
  SlicerAstro [3,4] is an extension of 3D Slicer [5] that aims to provide astronomers with a powerful and interactive visualization environment. In this environment, astronomers can analyze complex sources that automated pipelines such as SoFiA [6] find. These sources include interacting galaxies, tidal tails, HI filaments, and stripped galaxies.
 </p>
 <div class="wp-caption aligncenter" id="attachment_15232" style="width: 560px">
  <img alt="SlicerAstro displays a module that introduces the software." class="size-full wp-image-15232" height="614" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome-269x300.jpg 269w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome-220x246.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome-250x279.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome-355x396.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/SlicerAstroWelcome-90x100.jpg 90w" width="550"/>
  <p class="wp-caption-text">
   SlicerAstro displays a module that introduces the software.
  </p>
 </div>
 <p>
  An exhaustive review of open-source 3D visualization packages [2] led to the choice of 3D Slicer as the preferred platform for the development of SlicerAstro. The factors behind this choice include the following:
 </p>
 <ul>
  <li>
   3D Slicer is an open-source platform with a Berkeley Software Distribution (BSD) license, which allows for free utilization of the software.
  </li>
  <li>
   The software has a flexible environment for code development and collaboration.
  </li>
  <li>
   3D Slicer has adequate documentation for both developers and users.
  </li>
  <li>
   The 3D Slicer software has a number of active developers.
  </li>
  <li>
   The 3D Slicer interface already implements numerous quantitative features.
  </li>
 </ul>
 <p>
  In addition, the medical visualization tools that 3D Slicer implements suit the needs of astronomical applications. For example, 3D Slicer optimizes the display layout and the process of navigating through data for parallel two-dimensional visualizations (e.g., movies of channel maps).
 </p>
 <p>
  <span style="color: #000080;">
   <strong>
    Three-dimensional Inspection of HI in Galaxies
   </strong>
  </span>
 </p>
 <p>
  The following example uses an observation of the WEIN069 galaxy in the Perseus-Pisces supercluster filament. The example shows in detail the character of a radio emission of HI in and around the galaxy. The example also illustrates the benefits of 3D data visualization.
 </p>
 <p>
  In the following video, a 3D view displays the HI distribution and the kinematics of WEIN069. The view provides an immediate summary of the structures in the data that pertain to space and velocity. The view confirms that the structures are coherent in all three dimensions. Two spatial dimensions (right ascension, α, and declination, δ) measure the projection of HI onto the sky. The radial velocity dimension measures the velocity of HI along the line of sight.
 </p>
 <p>
  <span class="embed-youtube" style="text-align:center; display: block;">
   <iframe allowfullscreen="true" class="youtube-player" height="360" src="https://www.youtube.com/embed/yLjW9nbdO8g?version=3&amp;rel=1&amp;fs=1&amp;autohide=2&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;wmode=transparent" style="border:0;" type="text/html" width="640">
   </iframe>
  </span>
 </p>
 <p>
  Here, SlicerAstro generates a volume rendering of a galaxy in the Perseus-Pisces supercluster filament. The different colors highlight various intensity levels in the data. Grey, green, blue, and red correspond to three, eight, 15, and 20 times the root mean square noise, respectively.
 </p>
 <p>
  In this case, two main components are visible. The first component is a central body. This body illustrates the regularly rotating disk of the galaxy. Three-dimensional warping results from the projected rotation of the disk. The second component is a tail of unsettled gas that results from tidal interaction with another galaxy. The tail relates to the rotating disk in terms of space and velocity.
 </p>
 <p>
  The 3D structure of the HI data is difficult to interpret for several reasons. The third axis of the data cube measures frequency. It is possible to convert frequency into velocity with the Doppler formula. The following image shows a galaxy with velocity components 1, 2, and 3 along the line of sight. The projection of the velocities along the line of sight and the corresponding Doppler shifts account for the observation of these components at different frequencies. For a given projection on the sky of a galaxy, geometric properties determine the precise projection of the velocity components, which dictate the kinematic information of the observation. Such properties include the inclination and the position angle of the semi-major axis as well as the distribution of gas along the line of sight. The projection of the velocity components of a rotating system then determines the 3D shape that SlicerAstro visualizes.
 </p>
 <p>
  While SlicerAstro facilitates the analysis of typical HI data sets, astronomers still require training to interpret the 3D structure of the data and to get acquainted with the SlicerAstro tool itself. During this training process, interactivity is a key factor because it allows flexible viewing of the data.
 </p>
 <div class="wp-caption aligncenter" id="attachment_15237" style="width: 560px">
  <img alt="A schematic image shows a rotating galaxy. In the bottom-left corner, the image displays the profile of a schematic line along the line of sight." class="size-full wp-image-15237" height="237" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/scheme.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/scheme.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/scheme-300x129.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/scheme-220x95.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/scheme-250x108.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/scheme-355x153.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/scheme-90x39.jpg 90w" width="550"/>
  <p class="wp-caption-text">
   A schematic image shows a rotating galaxy. In the bottom-left corner, the image displays the profile of a schematic line along the line of sight.
  </p>
 </div>
 <p>
  <span style="color: #000080;">
   <strong>
    Current Status of SlicerAstro
   </strong>
  </span>
 </p>
 <p>
  SlicerAstro is an open-source project that is currently available in the extensions manager of 3D Slicer. Although SlicerAstro is still under development, it already offers several stable features for the qualitative visualization and inspection of HI in galaxies. For example, SlicerAstro can import and save astronomical data in the Flexible Image Transport System (FITS) format [7]. SlicerAstro loads such data as AstroVolume data structures. These structures store 3D astronomical images, FITS headers, and information from the astronomical world coordinate system (WCS) [8,9].
 </p>
 <div class="wp-caption aligncenter" id="attachment_15249" style="width: 745px">
  <img alt="SlicerAstro loads a FITS file." class="size-full wp-image-15249" height="94" sizes="(max-width: 735px) 100vw, 735px" src="https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File.png" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File.png 735w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-300x38.png 300w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-220x28.png 220w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-250x32.png 250w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-355x45.png 355w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-730x93.png 730w, https://blog.kitware.com/wp-content/uploads/2016/07/Loading-FITS-File-90x12.png 90w" width="735"/>
  <p class="wp-caption-text">
   SlicerAstro loads a FITS file.
  </p>
 </div>
 <p>
  SlicerAstro also displays quantitative information such as coordinate values and axes for two-dimensional views using the WCS.
 </p>
 <div class="wp-caption aligncenter" id="attachment_15238" style="width: 560px">
  <img alt="SlicerAstro illustrates the astronomical WCS." class="size-full wp-image-15238" height="389" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/WCS.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/WCS.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/WCS-300x212.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/WCS-220x156.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/WCS-250x177.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/WCS-355x251.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/WCS-90x64.jpg 90w" width="550"/>
  <p class="wp-caption-text">
   SlicerAstro illustrates the astronomical WCS.
  </p>
 </div>
 <p>
  In addition, SlicerAstro optimizes interactive smoothing for HI data [10] that runs on multi-core CPUs, OpenMPs, graphical processing units, and OpenGL.
 </p>
 <div class="wp-caption aligncenter" id="attachment_15240" style="width: 560px">
  <img alt="SlicerAstro implements a module for smoothing data." class="size-full wp-image-15240" height="306" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/smoothing.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/smoothing.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/smoothing-300x167.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/smoothing-220x122.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/smoothing-250x139.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/smoothing-355x198.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/smoothing-90x50.jpg 90w" width="550"/>
  <p class="wp-caption-text">
   SlicerAstro implements a module for smoothing data.
  </p>
 </div>
 <p>
  <span style="color: #000080;">
   Next Step: Modeling and Comparative Visualization of HI in Galaxies
  </span>
 </p>
 <p>
  Interactively visualizing kinematic models (e.g., tilted-ring models that describe the rotation and geometry of HI) and data can help highlight asymmetries, extra-planar gas, tidal tails, and other special features. Changing model parameters and display parameters, for instance, can provide more effective comparisons of models and data.
 </p>
 <p>
  <div class="wp-caption aligncenter" id="attachment_15235" style="width: 560px">
   <img alt="SlicerAstro displays NGC2403 HI data from the Things survey. The blue segmentation represents a tilted-ring model of the regularly rotating disk, which 3D Barolo automatically fit to the data [11]. The green segmentation highlights the part of the data that the most-suitable model does not represent." class="size-full wp-image-15235" height="282" sizes="(max-width: 550px) 100vw, 550px" src="https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403.jpg 550w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403-300x154.jpg 300w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403-220x113.jpg 220w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403-250x128.jpg 250w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403-355x182.jpg 355w, https://blog.kitware.com/wp-content/uploads/2016/07/NGC2403-90x46.jpg 90w" width="550"/>
   <p class="wp-caption-text">
    SlicerAstro displays NGC2403 HI data from the Things survey. The blue segmentation represents a tilted-ring model of the regularly rotating disk, which 3D Barolo automatically fit to the data [11]. The green segmentation highlights the part of the data that the most-suitable model does not represent.
   </p>
  </div>
  It is possible to use the output model of automated model-fitting algorithms to visually highlight different components in a data cube. For example, the below image displays data from the NGC2403 galaxy. The image clearly shows the presence of an extra gas component. This component consists of extraplanar gas close to the disk of the galaxy that rotates at a lower velocity than the disk. Thus, the 3D visualization gives an immediate overview of different coherent structures in the galaxy.
 </p>
 <p>
  <span style="color: #000080;">
   <strong>
    Conclusion
   </strong>
  </span>
 </p>
 <p>
  Although the development of SlicerAstro mainly focuses on 3D HI data, it is a useful tool for any other type of 3D astronomical data such as optical data. Please contact the authors or submit an idea to the issue tracker to provide feedback on how to improve AstroSlicer [3].
 </p>
 <p>
  <span style="color: #000080;">
   <strong>
    Acknowledgement
   </strong>
  </span>
 </p>
 <p>
  Support for SlicerAstro came from the European Research Council under the Seventh Framework Programme of the European Union (FP/2007-2013)/ERC Grant Agreement nr. 291-531. Support also came from Steve Pieper (Isomics, Inc.) and Andras Lasso (Laboratory of Percutaneous Surgery at Queen’s University) in the form of feedback and  assistance.
 </p>
 <p>
  <span style="color: #000080;">
   <strong>
    References
   </strong>
  </span>
 </p>
 <p>
  [1] Oosterloo, Tom, Marc Verheijen, and Wim van Cappellen. “The latest on Apertif.” Proceedings of Science (2010): 43–53.
 </p>
 <p>
  [2] Punzo, Davide, Thijs van der Hulst, Jos B.T.M. Roerdink, Tom Oosterloo, Mpati Ramatsoku, and Marc Verheijen. “The role of 3-D interactive visualization in blind surveys of HI in galaxies.” Astronomy and Computing 12 (2015): 86–99.
 </p>
 <p>
  [3] Github, Inc. “Punzo / SlicerAstro.”
  <a href="https://github.com/Punzo/SlicerAstro">
   https://github.com/Punzo/SlicerAstro
  </a>
  .
 </p>
 <p>
  [4] European Research Council and Kapteyn Astronomical Institute. “Documentation/Nightly/Extensions/SlicerAstro.”
  <a href="https://www.slicer.org/slicerWiki/index.php/Documentation/Nightly/Extensions/SlicerAstro">
   https://www.slicer.org/slicerWiki/index.php/Documentation/Nightly/Extensions/SlicerAstro
  </a>
  .
 </p>
 <p>
  [5] Fedorov Andrey, Reinhard Beichel, Jayashree Kalpathy-Cramer, Julien Finet, Jean-Christophe Fillion-Robin, Sonia Pujol, Christian Bauer, Dominique Jennings, Fiona Fennessy, Milan Sonka, John Buatti, Stephen Aylward, James V. Miller, Steve Pieper, and Ron Kikinis. “3D Slicer as an Image Computing Platform for the Quantitative Imaging Network.” Magnetic Resonance Imaging 30 (2012):1323–1341. pmid: 22770690.
 </p>
 <p>
  [6] Serra, Paolo, Tobias Westmeier, Nadine Giese, Russell Jurek, Lars Flöer, Attila Popping, Benjamin Winkel, Thijs van der Hulst, Martin Meyer, Bärbel S. Koribalski, Lister Staveley-Smith, and Hélène  Courtois. “SOFIA: a flexible source finder for 3D spectral line data.” Monthly Notices of the Royal Astronomical Society 448 (2015): 1922–1929.
 </p>
 <p>
  [7] Pence, William D., Lucio Chiappetti, Clive G. Page, Richard Allen Shaw, and Elizabeth Stobie. “Definition of the Flexible Image Transport System (FITS), version 3.0.” Astronomy and Astrophysics 524 (2010): A42.
 </p>
 <p>
  [8] Calabretta, Mark Raymond, and E. W. Greisen. “Representations of celestial coordinates in FITS.” Astronomy and Astrophysics 395 (2002): 1077–1122.
 </p>
 <p>
  [9] Greisen, E.W., Mark Raymond Calabretta, Francisco Gabriel Valdes, and Stephen L. Allen. “Representations of spectral coordinates in FITS.” Astronomy and Astrophysics 446 (2006): 747–771.
 </p>
 <p>
  [10] Punzo, Davide, Thijs van der Hulst, and Jos B. T. M. Roerdink.”Finding faint HI structure in and around galaxies: scraping the barrel.” Paper submitted to Astronomy and Computing, 2016.
 </p>
 <p>
  [11] Di Teodoro, Enrico, and Filippo Fraternali. “3D BAROLO: a new 3D algorithm to derive rotation curves of galaxies.” Monthly Notices of the Royal Astronomical Society 451 (2015): 3021–3033.
 </p>
 <p>
  <strong>
   <img alt="davide_headshot" class="size-full wp-image-15243 alignleft" height="125" sizes="(max-width: 100px) 100vw, 100px" src="https://blog.kitware.com/wp-content/uploads/2016/07/davide_headshot.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/davide_headshot.jpg 100w, https://blog.kitware.com/wp-content/uploads/2016/07/davide_headshot-90x113.jpg 90w" width="100"/>
   Davide Punzo
  </strong>
  is a doctoral student at the Kapteyn Astronomical Institute of the University of Groningen. His research interests not only include the domains of technology, computational sciences, and visualization, but they include the applications of these domains in astronomy.
 </p>
 <p>
 </p>
 <p>
  <strong>
   <img alt="thijs_headshot" class="size-full wp-image-15244 alignleft" height="125" sizes="(max-width: 100px) 100vw, 100px" src="https://blog.kitware.com/wp-content/uploads/2016/07/thijs_headshot.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/thijs_headshot.jpg 100w, https://blog.kitware.com/wp-content/uploads/2016/07/thijs_headshot-90x113.jpg 90w" width="100"/>
   Thijs van der Hulst
  </strong>
  is a professor in radio astronomy at the Kapteyn Astronomical Institute of the University of Groningen. His expertise is in the structure and evolution of galaxies, with special focus on the relation of the interstellar gas component to star formation and the buildup of stellar mass in galaxies.
 </p>
 <p>
  <strong>
   <img alt="jos_headshot" class="size-full wp-image-15245 alignleft" height="125" sizes="(max-width: 100px) 100vw, 100px" src="https://blog.kitware.com/wp-content/uploads/2016/07/jos_headshot.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/jos_headshot.jpg 100w, https://blog.kitware.com/wp-content/uploads/2016/07/jos_headshot-90x113.jpg 90w" width="100"/>
   Jos B.T.M. Roerdink
  </strong>
  received a Doctor of Philosophy in Theoretical Physics from Utrecht University in 1983. He currently is a professor and the director at the Johann Bernoulli Institute for Mathematics and Computer Science of the University of Groningen. There, he holds a chair in scientific visualization and computer graphics.
 </p>
 <p>
  <strong>
   <img alt="jc_headshot" class="size-full wp-image-15246 alignleft" height="125" sizes="(max-width: 100px) 100vw, 100px" src="https://blog.kitware.com/wp-content/uploads/2016/07/jc_headshot.jpg" srcset="https://blog.kitware.com/wp-content/uploads/2016/07/jc_headshot.jpg 100w, https://blog.kitware.com/wp-content/uploads/2016/07/jc_headshot-90x113.jpg 90w" width="100"/>
   Jean-Christophe Fillion-Robin
  </strong>
  is a technical expert and the lead developer of 3D Slicer at Kitware. He is also the lead developer of 3D Slicer for the National Alliance for Medical Image Computing (NA-MIC) community. As such, he developed the infrastructure for 3D Slicer extensions and worked on the port of 3D Slicer to Qt. He also co-created the open-source Common Toolkit (CTK).
 </p>
</div>
